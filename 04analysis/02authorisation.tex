\subsection{Authorisation}

When someone is authorise to use a system, it means they have permission to access that system. However, in enterprise access control scenario, there are other concepts associated with authorisation, rather than only verifying whether a user is allowed to use a certain system. The support for federated identity and the ability to handle \acrfull{sso} are typically design parameters that fall under the broader authorisation scope. Technologies that support these are discussed in the following section.

We can assume that an enterprise operates a variety of different IT systems, some of which may operate within the enterprise's security realm, while others may be \acrshort{saas} or may be operated by a business partner. To avoid an employee needing to manage several sets of credentials (one set for each system), federated identity is used. The access control system in an enterprise needs to be able to integrate with business application, so that federated identity can be used to access applications throughout the application landscape.

Once we acknowledge that a user should be able to use a single account (i.e. one set of credentials) to log in to both internal and external applications, we should further aim to reduce the number of times these credentials need to be entered, as the user logs into different systems, but without compromising the security of these systems. Single sign on addresses this need. With the single sign on, we could for example specify, that the user only needs to authenticate with their credentials once per two hours on a single machine. Once the user has authenticated, all the following requests to log in to any application using user's federated identity will be carried out without prompting the user to authenticate again, until the time limit has expired. This increases the convenience for the user.

Several technologies on the market support this approach. The most prominent ones, which we consider further are \acrshort{saml} and the OAuth + \acrshort{oidc} combination. Business applications that support federated identity integration, tend to support at least one of these technologies. While we could not find statistics comparing the use of the two in enterprises, we found examples of applications supporting both \acrshort{saml} and OAuth + \acrshort{oidc} and examples of applications that only support \acrshort{saml} (see Appendix~\ref{sec:appendix-links} for details). 

By some, \acrshort{saml} is considered as the enterprise-oriented technology, while OAuth and \acrshort{oidc} are considered oriented on the consumer market~\cite{Fagbemi2016ComparingWS-Federation, SoftwareSecured2016Differentiating2, OneLoginInc.SAMLOAuth}. However, OAuth and \acrshort{oidc} have been published 7 and 9 years  (respectively) after \acrshort{saml}. It is therefore understandable, that \acrshort{saml} is still widely present in the enterprise market. However, both technologies can be used in an enterprise environment, as noted by~\cite{Naik2017SecuringConnect} and some even encourage the use of OAuth + \acrshort{oidc} as the preferred way for new applications~\cite{barbkess2019SingleDirectory}.

Advantages of \acrshort{saml} include speed, identity-provider-initiated \acrshort{sso} and wide adoption~\cite{OneLoginInc.SAMLOAuth, Naik2017SecuringConnect}. The weaknesses are the limited support for mobile/native applications and heavy weight of the protocol (due to XML)~\cite{Naik2017SecuringConnect}. Conversely, the advantages of OAuth in combination with \acrshort{oidc} include better support for mobile and native applications, and more light-weight and REST-friendly protocol~\cite{Naik2017SecuringConnect}. There exists a proposal to improve the speed of OAuth in an enterprise setting~\cite{Noureddine2011AEnterprise}.

Because of better suitability for mobile and native applications, we propose OAuth + \acrshort{oidc} as the primary choice of authorisation and \acrshort{sso} protocols for internal enterprise applications and for external applications that support these technologies. Naturally, the system is likely to be integrated with internal legacy applications and external applications that do not support OAuth + \acrshort{oidc} for \acrshort{sso}. While a solution was proposed to enable OAuth functionality on legacy systems via \acrfull{esb}, this is not yet widely adopted and requires integration of an \acrshort{esb}~\cite{deSousaRibeiro2018AnBus}. Therefore the system should also support the \acrshort{saml} flow to accommodate these legacy systems.



% maybe-TODO Which scopes need to be included
% maybe-TODO Which entities will be needed to support this (Authorisation server)

% maybe-TODO OAuth will be used for boxes 3 and 4 from access control breakdown chart