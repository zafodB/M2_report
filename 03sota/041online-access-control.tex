\subsubsection{Online access control -- Microsoft}\label{sec:online-access-control}

For the online access control, we choose Microsoft and its Azure Active Directory (Azure AD)\footnotemark as the benchmark solution, as it is described as ``the leader in its field''~\cite{Kreizman2018MagicWorldwide}. It offers directory services, user authentication and authorisation of users' application access as the core of its functionality, and is primarily targeted on enterprises and organisations, irrespective of size. Microsoft claims that in 2013 50\% of companies on the Fortune~500 list were already using Azure AD and by 2017, this number has grown to 90\%~\cite{Martin201350Azure}.

\footnotetext{\url{https://azure.microsoft.com/en-us/services/active-directory/}, accessed 25 March 2019}

\paragraph{Authentication} Azure AD uses passwords as the primary user authentication method and this setting cannot be changed~\cite{Flores2019AuthenticationMethods}. To provide additional security, \acrlong{mfa} can be enabled. Additional factors that are supported by the solution include:
\begin{enumerate*}[label=(\roman*)]
    % \item \textit{security questions},
    % \item \textit{email address},
    \item \textit{SMS} and \textit{voice call},
    \item \textit{Microsoft Authenticator application},
    \item \textit{one-time passwords}, and 
    \item \textit{OATH hardware tokens}\footnotemark~\cite{Flores2019AuthenticationMethods}.
\end{enumerate*}

Either the enterprise administrator or the user themselves can decide, which of these is used as the second authentication factor. Once enabled, the second factor is always required during user sign-in. Exceptions to this can be defined based on countries, locations, or IP ranges. Moreover, email address and security questions can be added by the user as an additional factor, which can only be used during password recovery, but not during sign-in~\cite{eross-msft2018ConfigureAuthentication}.

\footnotetext{Note, that \acrshort{oath} is different from OAuth. \acrshort{oath} hardware tokens are \acrshort{otp} devices following the reference architecture defined by \acrfull{oath}.

\url{https://openauthentication.org/}, accessed 25 March 2019}

\paragraph{Single Sign-on} Azure AD supports both \acrshort{saml} and OAuth + OpenID Connect for single sign-on to non-Microsoft applications. Developers are encouraged to only use OAuth + OpenID Connect for new applications, but \acrshort{saml} can still be used with legacy and other software that does not support OAuth + OpenID~\cite{barbkess2019SingleDirectory}. 

All four types of authorisation grants (explained in Section \ref{sec:OAuth_2}) defined in OAuth specification can be used. The ID token which is issued during the OpenID connect flow, contains the standard claims defined in the specification. Two endpoints are defined to handle OAuth + OpenID Connect protocols -- v1.0 and v2.0. Together, the two endpoints support variety of languages (.NEt, JavaScript, Python, Java and other) and target applications (on-premise, cloud-based, hybrid)~\cite{deGuzman2018AboutPlatform}.

Azure AD further supports password-based, HTML header-based  and Integrated Windows Authentication \acrlong{sso}~\cite{barbkess2019SingleDirectory}. These are out of scope for this report.

\paragraph{Application access policy management} When a new application is integrated with Azure AD, the access to this application needs to be provisioned to users. This can be done on an individual or a group basis (role-based access control). 

Attribute-based access control is also implemented to a limited degree via use of the \textit{conditional access} method. When this method is in use, additional parameters can be evaluated, such as location, whether \acrshort{mfa} has been used, whether the user is using a compliant device and other predefined attributes. Furthermore, the enterprise administrator can further define custom criteria that need to be met (such as authentication with an external provider)~\cite{Vilcinskas2019WhatAccess}.